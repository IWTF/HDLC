

我的一些思路，以及要实现的功能。你看一看，然后我们讨论一下可行性，以及哪些功能要实现，哪些不实现

### HDLC实验思路

因为实验要求是模拟HDLC通信过程，并不要求真正实现

使用unix socket IPC模拟链路层的全双工通信

#### 组帧

帧结构：74-86 PPT

协议的特点是所传输的一帧数据可以是**任意位**，而且它是靠约定的位组合模式，我们把一个帧结构拆分为多个小的结构，发送时组合在一起; 接收时，可以根据帧结构的特点，先判断帧类型，再根据帧特点获取各字段（ |xxx|Information|FCS|   , 可以先获取后面定长数据，最终前后下标之间的为INformation）

组帧时需要注意的地方

- "0"位插入和删除技术（比特填充）

#### 分片

不知道分片的依据是什么，所以还没有考虑

#### 建立链接/拆除链接

PPT 87-91页

询问/确定方式，sever被动等待clinet的链接

还是帧的发送，应该没太多问题。连接建立时，第一帧，根据课上讲的，确定协议，窗口大小之类的; 拆链时，

#### 流量控制、差错控制——返回N的滑动窗口协议

滑动窗口：

差错控制：47-51页 PPT

* 关于滑动窗口，定义了一个window结构体，用来表示滑动窗口

  现在只定义了3个字段：起始地址，结束地址，窗口大小；有以下关系

  编号数目 =  窗口大小 - 1

  编号 = （地址 - buffer）% 编号数目

* 模拟数据帧的发送，肯定不能直接全部发出去...这里可以根据接收窗口的值，动态的发送相应数量的数据帧
  * 参考一：对方反馈的接收窗口的大小
  * 参考二：根据窗口大小，再产生该范围内的随机数（表示发送的数量），进一步增加发送的不确定性，相当于模仿网络状态
  
* 传输过程中的**差错**，帧损伤，帧丢失，也通过随机数来决定

  通过对随机数做一些限定，使其满足条件的概率为某值，达到模拟的目的

  超时重传，没想好怎麽设置，大概是在recv处设置时钟，长时间未收到有效帧，就重发？

  这个应该是要实现的吧？不然差错控制好像没什么用了，具体模拟方法可以再讨论

  

  **这个应该是要实现的吧？不然差错控制好像没什么用了**，具体模拟方法可以再讨论

  

  

### 问题：	

1. 关于帧的数据字段，应该怎麽获取，我们在终端输入吗？还是读取一个文件？

2. 信息帧，Information字段大小如何设置？根据什么原则

3. 数据帧如何保存？（方便重传的那个机制），保存后在需要重传时

  PPT56页，提到了keep a buffer equal to window size， 想知道怎麽能高效的找到需要重传的帧？

4. 如何模拟网络环境？用不用模拟哪一帧先到，或某一帧后到；

5. 如何模拟接收方收到1,2,3, 直接发送ack4

### 参考资料:
[HDLC协议的一些细节](https://www.voorp.com/a/HDLC%E5%8D%8F%E8%AE%AE)

### 项目相关

使用了Cmake，方便生成Makefile对项目进行构建，这里有一片详细教程

[CMake入门实战](https://www.hahack.com/codes/cmake/)，大致能看懂CMakeLists.txt就行，反正我们用的程度不深，看到多目录，多源文件就可以（而且CMakeLists.txt在之后写的过程中应该是不用再修改了）

项目目录里有一个Demo的文件夹，里面是CMake练手的小demo，里面有比博客里多了2点，

1. 使用LINK_LIBRARIES(-lm) 引入库文件
2. include_directories(include) 添加头文件路径，这样写后，在main.c文件里，引用头文件，不需要写`#include './include/golbal.h'`，直接头文件名就行



我们实验，server和client共用库函数，所以就在最外面的CMakeLists里面生成了两个可执行文件

> 进入build文件夹下，执行
>
> cmake ../
>
> 会生成项目的Makefile文件，在build文件夹下，然后执行
>
> make
>
> 编译可执行程序，都在build文件夹下（本来想更改一下可执行文件的目录，不过发现改后，执行不方便，目录结构也不好看）
>
> 现在是把，项目可执行程序，构建文件，以及unix socket用到的那个文件都放在了build下


#### HDLC特点
三种类型的站点、两种链路，三种数据传送操作方式

=======实验用的那一种方法？？？没有区分开=======

在不提供捎带时，信息帧负责传送数据; 监督帧负责ARQ（重传机制）; 无编号帧提供了增补的链路控制功能
一、 初始化
  1. 通知对方
  2. 选择三种数据传送方式中的一种
  3. 确定序号的位数 3/7位 
  另一方接受这个请求，则发送无编号确认帧。如果拒绝，则发送拆链帧（DM）
二、 逻辑连接
  当初始化请求被接受后，就会建立起一个逻辑连接，双方都可以通过发送I帧开始发送用户数据
#### 帧同步
每个帧的开始和结束必须容易辨别


#### 流量控制
发送站点发送帧的速度，不能超过接收站点接纳这些帧的速度
书上提到：假设所有帧发送时按顺序的，但在传送过程中会遭受到任意的不等量的时延

#### 差错控制
传输系统引起的比特差错必须纠正（丢失，比特差错）


